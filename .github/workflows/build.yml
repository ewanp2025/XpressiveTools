name: Windows Minimal Portable Build

on:
  push:
    branches:
      - master # Triggers the workflow on push to the master branch (adjust as needed)

jobs:
  build_windows:
    runs-on: windows-latest # Specifies the Windows virtual machine runner

    steps:
      - uses: actions/checkout@v4 # Checks-out your repository under $GITHUB_WORKSPACE

      - name: Setup MSVC development environment
        uses: ilammy/msvc-dev-cmd@v1 # Helper action to configure the Visual C++ environment

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' # Python is needed for aqtinstall

      - name: Install Qt6
        run: |
          pip install aqtinstall
          python -m aqt install-qt --output ${{ github.workspace }}/Qt windows desktop 6.6.1 win64_msvc2019_64
          echo "${{ github.workspace }}/Qt/6.6.1/msvc2019_64/bin/" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        shell: cmd # Use cmd shell for Windows-specific commands

      - name: Configure and Build
        shell: cmd
        run: |
          # Adjust 'YourProject.pro' and 'src/' to match your project structure
          cd src/
          qmake6 YourProject.pro -spec win32-msvc
          nmake # Use nmake for building with MSVC, or 'cmake --build .' if using CMake
